name: Keep Supabase Alive (Direct DB)

on:
  schedule:
    # Run at 08:00 UTC every day
    - cron: '0 8 * * *'
  workflow_dispatch: # Allow manual trigger

jobs:
  ping-db:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Supabase REST API
        run: |
          # Query the 'pages' table directly via Supabase REST API
          # This bypasses the frontend and wakes up the DB directly.
          
          curl -f -s -o /dev/null -w "%{http_code}" \
          -X GET '${{ secrets.SUPABASE_URL }}/rest/v1/pages?select=id&limit=1' \
          -H "apikey: ${{ secrets.SUPABASE_KEY }}" \
          -H "Authorization: Bearer ${{ secrets.SUPABASE_KEY }}"
          
          echo "Ping sent to Supabase REST API."
